[{
  "name": "BubbleBlock",
  "description": "Adware and Malware Blocker",
  "url": "https://bubblev.com/apps/bblock",
  "template": true,
  "enabled": true,
  "dataConfig": {
    "driverClass": "bubble.app.bblock.BubbleBlockApp",
    "presentation": "app",
    "fields": [
      {"name": "ctime", "customFormat": true},
      {"name": "device"},
      {"name": "fqdn"},
      {"name": "uri"},
      {"name": "data"}
    ],
    "params": [
      {"name": "device", "required": false, "index": 10},
      {"name": "meta2", "required": false, "operator": "like", "index": 20}
    ],
    "views": [
      {"name": "last_24_hours"},
      {"name": "last_7_days"},
      {"name": "last_30_days"}
    ],
    "configViews": [{
      "name": "manage_blocklists",
      "type": "list",
      "columns": ["name", "description", "url", "enabled", "tags"],
      "actions": [
        {"name": "enable_blocklist", "when": "!item.enabled"},
        {"name": "disable_blocklist", "when": "item.enabled"},
        {"name": "manage_blocklist", "view": "manage_blocklist"},
        {"name": "remove_blocklist"},
        {"name": "add_blocklist", "type": "create", "view": "manage_blocklist"}
      ]
    }, {
      "name": "manage_blocklist",
      "type": "item",
      "fields": [
        {"name": "name"},
        {"name": "description", "control": "textarea"},
        {"name": "url", "type": "http_url"},
        {"name": "tags"},
        {"name": "enabled", "type": "flag"}
      ],
      "actions": [
        {"name": "enable_blocklist", "when": "!item.enabled"},
        {"name": "disable_blocklist", "when": "item.enabled"},
        {"name": "remove_blocklist", "when": "item.id !== null"},
        {"name": "create_blocklist", "when": "item.id === null"},
        {"name": "update_blocklist", "when": "item.id !== null"},
        {"name": "manage_blocklist_entries", "when": "item.id !== null"}
      ]
    }, {
      "name": "manage_entries",
      "type": "list",
      "columns": ["block_rule"],
      "actions": [
        {"name": "remove_rule"},
        {"name": "add_rule", "type": "create", "view": "add_entry"}
      ]
    }, {
      "name": "add_entry",
      "type": "item",
      "fields": [ {"name": "block_rule"} ],
      "actions": ["create_rule"]
    }]
  },
  "children": {
    "AppSite": [{
      "name": "All_Sites",
      "url": "*",
      "description": "All websites",
      "template": true
    }],
    "AppRule": [{
      "name": "bubble_block",
      "template": true,
      "driver": "BubbleBlock",
      "priority": -1000,
      "config": {
        "blockLists": [
          {
            "name": "EasyList",
            "id": "easylist",
            "url": "https://v.firebog.net/hosts/Easylist.txt",
            "description": "EasyList is the primary filter list that removes most adverts from international web pages, including unwanted frames, images, and objects. It is the most popular list used by many ad blockers and forms the basis of over a dozen combination and supplementary filter lists.",
            "tags": ["ads"]
          },
          {
            "name": "Dandelion Sprout's Anti-Malware List",
            "id": "dandelion_sprouts_anti_malware_list",
            "url": "https://raw.githubusercontent.com/DandelionSprout/adfilt/master/Alternate%20versions%20Anti-Malware%20List/AntiMalwareABP.txt",
            "description": "Most anti-malware lists are pretty big and can cover a 5- or 6-digit amount of specific domains. But my list hereby claims to remove more than 25% of all known malware sites with just a 2-digit amount of entries. This is mostly done by blocking top-level domains that have become devastatingly abused by spammers, usually because they allowed for free and uncontrolled domain registrations. There's also additional categories that cover unusual malware and phishing domains that very few other lists seem to cover.",
            "tags": ["malware", "phishing"]
          },
          {
            "name": "Bubble Custom List",
            "id": "local",
            "url": "",
            "description": "A place to maintain your own block rules for this Bubble.",
            "tags": ["custom"]
          }
        ]
      }
    }],
    "AppMessage": [{
      "locale": "en_US",
      "messages": [
        {"name": "name", "value": "BubbleBlock"},
        {"name": "description", "value": "Adware and Malware Blocker"},
        {"name": "field.ctime", "value": "When"},
        {"name": "field.fqdn", "value": "URL"},
        {"name": "field.device", "value": "Device"},
        {"name": "field.uri", "value": "Path"},
        {"name": "field.data", "value": "Count"},
        {"name": "view.last_24_hours", "value": "Last 24 Hours"},
        {"name": "view.last_24_hours.ctime.format", "value": "{{MM}} {{d}} @ {{h}}{{a}}"},
        {"name": "view.last_7_days", "value": "Last 7 Days"},
        {"name": "view.last_7_days.ctime.format", "value": "{{MM}} {{d}}, {{YYYY}}"},
        {"name": "view.last_30_days", "value": "Last 30 Days"},
        {"name": "view.last_30_days.ctime.format", "value": "{{MM}} {{d}}, {{YYYY}}"},

        {"name": "config.field.name", "value": "Name"},
        {"name": "config.field.description", "value": "Description"},
        {"name": "config.field.url", "value": "URL"},
        {"name": "config.field.tags", "value": "Tags"},
        {"name": "config.field.tags.description", "value": "A comma-separated list of tags: "},
        {"name": "config.field.enabled", "value": "Enabled"},
        {"name": "config.field.block_rule", "value": "Rule"},

        {"name": "config.action.enable_blocklist", "value": "Enable"},
        {"name": "config.action.disable_blocklist", "value": "Disable"},
        {"name": "config.action.manage_blocklist", "value": "Manage List"},
        {"name": "config.action.remove_blocklist", "value": "Remove List"},
        {"name": "config.action.add_blocklist", "value": "Add New List"},
        {"name": "config.action.create_blocklist", "value": "Create List"},
        {"name": "config.action.update_blocklist", "value": "Update List"},
        {"name": "config.action.manage_blocklist_entries", "value": "Manage Entries"},
        {"name": "config.action.remove_rule", "value": "Remove Rule"},
        {"name": "config.action.add_rule", "value": "Add New Rule"},
        {"name": "config.action.create_rule", "value": "Create Rule"},

        {"name": "config.item.easylist.name", "value": "EasyList"},
        {"name": "config.item.easylist.description", "value": "EasyList is the primary filter list that removes most adverts from international web pages, including unwanted frames, images, and objects. It is the most popular list used by many ad blockers and forms the basis of over a dozen combination and supplementary filter lists."},
        {"name": "config.item.local.name", "value": "Bubble Custom List"},
        {"name": "config.item.local.description", "value": "A place to maintain your own block rules for this Bubble."},
        {"name": "config.item.dandelion_sprouts_anti_malware_list.name", "value": "Dandelion Sprout's Anti-Malware List"},
        {"name": "config.item.dandelion_sprouts_anti_malware_list.description", "value": "Most anti-malware lists are pretty big and can cover a 5- or 6-digit amount of specific domains. But my list hereby claims to remove more than 25% of all known malware sites with just a 2-digit amount of entries. This is mostly done by blocking top-level domains that have become devastatingly abused by spammers, usually because they allowed for free and uncontrolled domain registrations. There's also additional categories that cover unusual malware and phishing domains that very few other lists seem to cover."}
      ]
    }]
  }
}]